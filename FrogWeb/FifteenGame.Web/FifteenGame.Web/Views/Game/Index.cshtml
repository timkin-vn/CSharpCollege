@model FifteenGame.Web.Models.GameViewModel

@{
    ViewBag.Title = "Лягушка-попрыгушка";
}

<main class="container mt-4">
    <div class="text-center mb-4">
        <h1>🐸 Лягушка-попрыгушка 🐸</h1>
        <div class="alert alert-info fs-5">
            @Model.GameStatus
        </div>
    </div>

    @if (Model.IsGameOver)
    {
        <div class="text-center mb-4">
            @Html.ActionLink("Новая игра", "Restart", "Game", null, new { @class = "btn btn-success btn-lg" })
        </div>
    }

    <div class="game-board mx-auto" style="max-width: 600px;">
        @for (int row = 0; row < Model.RowCount; row++)
        {
            <div class="row mb-2">
                @for (int column = 0; column < Model.ColumnCount; column++)
                {
                    var cell = Model.Cells[row, column];

                    <div class="col p-1">
                        @if (cell.IsClickable && !Model.IsGameOver)
                        {
                            if (cell.IsAlgae)
                            {
                                @Html.ActionLink(cell.DisplayText, "RemoveAlgae", "Game",
                                    new { row = cell.Row, column = cell.Column },
                                    new
                                         {
                                        @class = cell.CssClass + " cell-button",
                                        title = cell.ToolTip,
                                        style = "font-size: 24px; width: 60px; height: 60px;"
                                    })
                            }
                            else if (cell.IsLilyPad)
                            {
                                @Html.ActionLink(cell.DisplayText, "SelectLilyPad", "Game",
                                    new { row = cell.Row, column = cell.Column },
                                    new
                                         {
                                        @class = cell.CssClass + " cell-button" + (Model.HasSelectedLilyPad ? " selected" : ""),
                                        title = cell.ToolTip,
                                        style = "font-size: 24px; width: 60px; height: 60px;"
                                    })
                            }
                            else if (cell.IsWater && Model.HasSelectedLilyPad)
                            {
                                @Html.ActionLink(cell.DisplayText, "MoveLilyPad", "Game",
                                    new { targetRow = cell.Row, targetColumn = cell.Column },
                                    new
                                         {
                                        @class = cell.CssClass + " cell-button",
                                        title = cell.ToolTip,
                                        style = "font-size: 24px; width: 60px; height: 60px;"
                                    })
                            }
                            else
                            {
                                <button class="@cell.CssClass"
                                        style="font-size: 24px; width: 60px; height: 60px;"
                                        title="@cell.ToolTip"
                                        disabled>
                                    @cell.DisplayText
                                </button>
                            }
                        }
                        else
                        {
                            <button class="@cell.CssClass"
                                    style="font-size: 24px; width: 60px; height: 60px;"
                                    title="@cell.ToolTip"
                                    disabled>
                                @cell.DisplayText
                            </button>
                        }
                    </div>
                }
            </div>
        }
    </div>

    <div class="text-center mt-4">
        <div class="alert alert-light">
            <h5>Как играть:</h5>
            <ul class="list-unstyled">
                <li>🌱 <strong>Кликайте на водоросли</strong> - чтобы убрать их</li>
                <li>🌿 <strong>Кликайте на кувшинки</strong> - чтобы выбрать для перемещения</li>
                <li>💧 <strong>Кликайте на воду</strong> - чтобы переместить выбранную кувшинку</li>
                <li>🐸 <strong>Лягушка двигается автоматически</strong> после ваших действий</li>
            </ul>
        </div>

        @Html.ActionLink("Новая игра", "Restart", "Game", null, new { @class = "btn btn-primary" })
    </div>
</main>

<style>
    .cell-button {
        transition: all 0.2s ease-in-out;
        border: 2px solid transparent;
    }

        .cell-button:hover {
            transform: scale(1.1);
            border-color: #ffc107;
        }

    .selected {
        border: 3px solid #dc3545 !important;
        box-shadow: 0 0 10px rgba(220, 53, 69, 0.5);
    }

    .game-board {
        background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
</style>