<Window x:Class="Pacman.Client.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Pacman.Client"
        xmlns:vm="clr-namespace:Pacman.Client.ViewModels"
        mc:Ignorable="d"
        Title="{Binding Title}" Height="650" Width="600"
        Background="Black"
        WindowStartupLocation="CenterScreen"
        KeyDown="Window_KeyDown">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <TextBlock Text="{Binding Title}" 
                   Foreground="#FFD700" 
                   FontSize="24" 
                   FontWeight="Bold" 
                   HorizontalAlignment="Center" 
                   Margin="10">
            <TextBlock.Effect>
                <DropShadowEffect Color="#FFD700" BlurRadius="10" ShadowDepth="0"/>
            </TextBlock.Effect>
        </TextBlock>

        <!-- Игровое поле -->
        <Border Grid.Row="1" 
                BorderBrush="#1919A6" 
                BorderThickness="4" 
                Margin="10" 
                HorizontalAlignment="Center" 
                VerticalAlignment="Center">

            <ItemsControl ItemsSource="{Binding Cells}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <!-- Черный фон игрового поля -->
                        <UniformGrid Columns="{Binding MapColumns}" Background="Black"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <!-- Контейнер клетки 20x20 -->
                        <Grid Width="20" Height="20">

                            <!-- 1. СТЕНА (Синий квадрат) -->
                            <Rectangle x:Name="WallShape" 
                                       Fill="#1919A6" 
                                       Visibility="Collapsed" 
                                       RadiusX="2" RadiusY="2" 
                                       Margin="0.5"/>

                            <!-- 2. ЕДА (Маленькая точка) -->
                            <Ellipse x:Name="CoinShape" 
                                     Fill="Gold" 
                                     Width="4" Height="4" 
                                     Visibility="Collapsed"
                                     HorizontalAlignment="Center" 
                                     VerticalAlignment="Center"/>

                            <!-- 3. ПАКМАН (Желтый круг) -->
                            <Ellipse x:Name="PacmanShape" 
                                     Fill="Yellow" 
                                     Visibility="Collapsed" 
                                     Margin="1"/>

                            <!-- 4. ПРИЗРАК (Красный скругленный квадрат) -->
                            <Border x:Name="GhostShape" 
                                    Background="Red" 
                                    CornerRadius="5,5,0,0" 
                                    Margin="1" 
                                    Visibility="Collapsed"/>

                        </Grid>

                        <!-- ТРИГГЕРЫ: Включают нужную фигуру в зависимости от типа клетки -->
                        <DataTemplate.Triggers>
                            <DataTrigger Binding="{Binding Type}" Value="Wall">
                                <Setter TargetName="WallShape" Property="Visibility" Value="Visible"/>
                            </DataTrigger>

                            <DataTrigger Binding="{Binding Type}" Value="Coin">
                                <Setter TargetName="CoinShape" Property="Visibility" Value="Visible"/>
                            </DataTrigger>

                            <DataTrigger Binding="{Binding Type}" Value="Pacman">
                                <Setter TargetName="PacmanShape" Property="Visibility" Value="Visible"/>
                            </DataTrigger>

                            <DataTrigger Binding="{Binding Type}" Value="Ghost">
                                <Setter TargetName="GhostShape" Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>
    </Grid>
</Window>