<Window x:Class="FifteenGame.Wpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Gem Match" Height="650" Width="550" 
        WindowStartupLocation="CenterScreen" Background="{StaticResource MainBackground}">
    <Grid Margin="10">
        <Border Background="{StaticResource PanelBackground}" CornerRadius="15" Padding="15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Background="#EEEEEE" CornerRadius="10" Padding="10" Margin="0,0,0,5">
                    <TextBlock Text="{Binding GameStatus}" FontSize="16" FontWeight="Bold" 
                               Foreground="#333" HorizontalAlignment="Center"/>
                </Border>

                <Border Grid.Row="1" Background="#FFF5E6" BorderBrush="Orange" BorderThickness="1" 
                        CornerRadius="10" Padding="8" Margin="0,0,0,10"
                        Visibility="{Binding GlobalBestVisibility}">
                    <TextBlock Text="{Binding GlobalBestInfo}" FontSize="14" FontWeight="Bold" 
                               Foreground="#D35400" HorizontalAlignment="Center"/>
                </Border>

                <Border Grid.Row="2" Background="#333" CornerRadius="5" Padding="5" Margin="0,0,0,10">
                    <ItemsControl ItemsSource="{Binding Cells}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Rows="8" Columns="8"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Command="{Binding ClickCommand}" CommandParameter="{Binding}"
                                        BorderBrush="White">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Grid Margin="2">
                                                <Border Name="SelectionBorder" BorderBrush="White" BorderThickness="0" CornerRadius="50"/>
                                                <Ellipse Fill="{Binding GemColor}" Width="40" Height="40">
                                                    <Ellipse.Effect>
                                                        <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.5"/>
                                                    </Ellipse.Effect>
                                                </Ellipse>
                                            </Grid>
                                            <ControlTemplate.Triggers>
                                                <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                    <Setter TargetName="SelectionBorder" Property="BorderThickness" Value="3"/>
                                                </DataTrigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Border>

                <Grid Grid.Row="3">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" Content="🔄 РЕСТАРТ" Command="{Binding NewGameCommand}" 
                            Style="{StaticResource GameButtonStyle}" Background="#1488CC"/>

                    <Button Grid.Column="2" Content="🚪 В МЕНЮ" Command="{Binding ExitCommand}" 
                            Style="{StaticResource GameButtonStyle}" Background="#E74C3C"/>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Window>